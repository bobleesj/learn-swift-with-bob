
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Bluetooth Low Energy Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../VISION.html">
            
                <a href="../../VISION.html">
            
                    
                    Vision
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../DIARY.html">
            
                <a href="../../DIARY.html">
            
                    
                    Diary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../WORK.html">
            
                <a href="../../WORK.html">
            
                    
                    Work
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" >
            
                <span>
            
                    
                    Object Oriented Programming
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="Functional_Swift.html">
            
                <a href="Functional_Swift.html">
            
                    
                    Functional Programming
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" >
            
                <span>
            
                    
                    Protocol Oriented Programming
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" >
            
                <span>
            
                    
                    RxSwift
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" >
            
                <span>
            
                    
                    iOS Interview Questions
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    iOS APIs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.5.1" data-path="Bluetooth_Low_Energy.html">
            
                <a href="Bluetooth_Low_Energy.html">
            
                    
                    Bluetooth Low Energy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" >
            
                <span>
            
                    
                    Animation
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" >
            
                <span>
            
                    
                    Memory Management
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" >
            
                <span>
            
                    
                    Grand Central Dispatch
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="Memory_Management.html">
            
                <a href="Memory_Management.html">
            
                    
                    Memory Management
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    Design Patterns
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="MVVM.html">
            
                <a href="MVVM.html">
            
                    
                    MVVM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" >
            
                <span>
            
                    
                    Delegate Pattern
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    Testing Driven Development
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" >
            
                <span>
            
                    
                    Unit Testing
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" >
            
                <span>
            
                    
                    UI Testing
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    Backend
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    Computer Science
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" >
            
                <span>
            
                    
                    Algorithm
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" >
            
                <span>
            
                    
                    Productivity
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../04_Productivity/Terminal.html">
            
                <a href="../04_Productivity/Terminal.html">
            
                    
                    Terminal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" >
            
                <span>
            
                    
                    Github
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" >
            
                <span>
            
                    
                    GitBook
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" >
            
                <span>
            
                    
                    Xcode
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" >
            
                <span>
            
                    
                    Soft Skills
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../05_Revenue_Generation/Sales.md">
            
                <span>
            
                    
                    Sales
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../05_Revenue_Generation/Marketing.md">
            
                <span>
            
                    
                    Online Presence
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" >
            
                <span>
            
                    
                    Language
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../06_Language/Writing_Fundamentals.html">
            
                <a href="../06_Language/Writing_Fundamentals.html">
            
                    
                    Writing Fundamentals
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../06_Language/English.html">
            
                <a href="../06_Language/English.html">
            
                    
                    English
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../06_Language/Korean.html">
            
                <a href="../06_Language/Korean.html">
            
                    
                    Korean
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="../../Contentl06_Language/Mandarin.md">
            
                <span>
            
                    
                    Mandarin
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" >
            
                <span>
            
                    
                    The Day
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../07_The_Day/Korean_History.html">
            
                <a href="../07_The_Day/Korean_History.html">
            
                    
                    Korean History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="../07_The_Day/Korean_Politics.html">
            
                <a href="../07_The_Day/Korean_Politics.html">
            
                    
                    Korean Politics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="../07_The_Day/The_US_History.html">
            
                <a href="../07_The_Day/The_US_History.html">
            
                    
                    The US History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.4" data-path="../07_The_Day/The_US_Politics.html">
            
                <a href="../07_The_Day/The_US_Politics.html">
            
                    
                    The US Politics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Bluetooth Low Energy</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="ble-feb-3-2017">BLE Feb, 3, 2017</h2>
<p>References: <a href="https://www.google.com" target="_blank">Apple&apos;s Documentation</a></p>
<p>By default, your app is unable to perform Bluetooth low energy tasks while it is in the background or in a suspended state. That said, if your app needs to perform Bluetooth low energy tasks while in the background, you can declare it to support one or both of the Core Bluetooth background execution modes (there&#x2019;s one for the central role, and one for the peripheral role). </p>
<p><img src="https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/Art/AdvertisingAndDiscovery_2x.png" alt="link"></p>
<p><img src="https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/Art/CBPeripheralData_Example_2x.png" alt="link"></p>
<p>A central can also interact with a peripheral&#x2019;s service by reading or writing the value of that service&#x2019;s characteristic. On the central side, a local central device is represented by a CBCentralManager object. These objects are used to manage discovered or connected remote peripheral devices (represented by CBPeripheral objects), including scanning for, discovering, and connecting to advertising peripherals.</p>
<p><img src="https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/Art/TreeOfServicesAndCharacteristics_Remote_2x.png" alt="link"></p>
<h3 id="common-central-role-task">Common Central Role Task</h3>
<ul>
<li>Start up a central manager object</li>
<li>Discover and connect to peripheral devices that are advertising</li>
<li>Explore the data on a peripheral device after you&#x2019;ve connected to it</li>
<li>Send read and write requests to a characteristic value of a peripheral&#x2019;s service</li>
<li>Subscribe to a characteristic&#x2019;s value to be notified when it is updated</li>
</ul>
<h2 id="starting-up-a-central-manager">Starting Up a Central Manager</h2>
<pre><code class="lang-swift">myCentralManager = <span class="hljs-type">CBCentralManager</span>(delegate: <span class="hljs-keyword">self</span>, queue: <span class="hljs-literal">nil</span>, options: <span class="hljs-literal">nil</span>)
</code></pre>
<p>In this example, <code>self</code> is set as the delegate to receive any central role events. By specifying the dispatch queue as nil, the central manager dispatches central role events using the main queue. </p>
<p>When you create a central manager, it calls the <code>centralManagerDidUpdateState</code> method of its delegate object. </p>
<blockquote>
<p>You must implement this delegate method to ensure that BLE is supported and available to use on the central device. </p>
</blockquote>
<h2 id="discovering-peripheral-devices-that-are-advertising">Discovering Peripheral Devices That Are Advertising</h2>
<p>Once initialized, the central manager&apos;s first task is peripheral discovery as it advertises themselves. Your app discovers nearby peripheral devices that are advertising by calling the central manager&apos;s <code>scanForPeripheralsWithServices:options:</code> method. </p>
<pre><code class="lang-swift">myCentralManager.scanForPeripheralsWithServices(<span class="hljs-literal">nil</span>, options: <span class="hljs-literal">nil</span>)
</code></pre>
<blockquote>
<p>If you specify <code>nil</code> for the first parameter, the central manager returns <em>all</em> discovered peripherals, regardless of the supported devices. In real apps, you tyically specify an array of <code>CBUUID</code> objects, each of which represents the universally unique identifier (UUID) of a service that a peripheral is advertising. </p>
</blockquote>
<p>Every time the central discovers a peripheral, it calls the <code>centralManager:didDiscoverPeripheral:advertisementData:RSSI:</code> method of its delegate objects. The newly discovered peripheral is returned as a <code>CBPeripheral</code> object. </p>
<pre><code class="lang-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">centralManager</span><span class="hljs-params">(central: CBCentralManager, 
                    didDiscoverPeripheral peripheral: CBPeripheral,
                    advertisementData: [NSObject : AnyObject],
                    RSSI: Int)</span></span> {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Discovered <span class="hljs-subst">\(peripheral.name)</span>&quot;</span>)
    <span class="hljs-keyword">self</span>.discoveredPeripheral = peripheral
}
</code></pre>
<p>If you expect to connect to multiple devices, you might keep instead an <code>Array</code> of discovered peripherals. In case you&apos;ve done finding, you can call</p>
<pre><code class="lang-swift"> myCentralManager.stopSacn
</code></pre>
<h2 id="discovering-the-characteristics-of-a-service">Discovering the Characteristics of a Service</h2>
<p>When you find a service that you are interested in, you request a connection to the peripheral by calling </p>
<pre><code class="lang-swift">myCentralManager.connect(peripheral, options: <span class="hljs-literal">nil</span>)
</code></pre>
<p>If the connection is successful, the central manager calls, <code>centralManager:didConnectPeripheral</code></p>
<pre><code class="lang-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">centralManager</span><span class="hljs-params">(<span class="hljs-number">_</span> central: CBCentralManager, didConnect peripheral: CBPeripheral)</span></span> {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Peripheral connected&quot;</span>)
    peripheral.delegate = <span class="hljs-keyword">self</span>
}
</code></pre>
<h2 id="discovering-the-services-of-a-peripheral-that-youre-connected-to">Discovering the Services of a Peripheral That You&apos;re Connected To</h2>
<pre><code class="lang-swift"> peripheral.discoveredServices(<span class="hljs-literal">nil</span>)
</code></pre>
<blockquote>
<p><strong>Note:</strong> In real app, you typically do not pass in <code>nil</code> as the parameter, because doing so returns all the services available on a peripheral device. Because a peripheral may contain many more services than you are interested in. It may waste battery life, and an unncessary use of time. You typically specify the UUIDs of the services that you already know you are interested in discovering. </p>
</blockquote>
<p>When the specified services are discovered, the peripheral calls the <code>peripheral:didDiscoverServices:</code> method of its delegate object. Core Bluetooth createa an array of <code>CBServices</code> objects. </p>
<pre><code class="lang-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">peripheral</span><span class="hljs-params">(<span class="hljs-number">_</span> peripheral: CBPeripheral, didDiscoverServices error: Error?)</span></span> {
    <span class="hljs-keyword">for</span> service: <span class="hljs-type">CBService</span> <span class="hljs-keyword">in</span> peripheral.services {

    }
}
</code></pre>
<h2 id="discovering-the-characteristics-of-a-service">Discovering the Characteristics of a Service</h2>
<p>When you find a service that you are interested in, the next step in exploring what a peripheral has to offer is discovering all of the service&apos;s characteristics. Call, <code>didcoverCharacteristics:forService:</code> method:</p>
<pre><code class="lang-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">peripheral</span><span class="hljs-params">(<span class="hljs-number">_</span> peripheral: CBPeripheral,
                didDiscoverCharacteristicsForservice: CBService,
                error: Error?)</span></span> {
    <span class="hljs-keyword">for</span> characteristic: <span class="hljs-type">CBCharacteristic</span> <span class="hljs-keyword">in</span> service.characteristics {

    }
}
</code></pre>
<h2 id="receiving-the-value-of-a-characteristic">Receiving the Value of a Characteristic</h2>
<p>A characteristic contains a single value that represents information about a peripheral&apos;s service. Ex) a temperature measurement characteristic of a health thermometer service may have a value that indicates a temperature in Celsius. </p>
<h3 id="reading-the-value-of-a-characteristic">Reading the Value of a Characteristic</h3>
<pre><code class="lang-swift">peripheral.readValue(<span class="hljs-keyword">for</span>: interestingCharacteristic)
</code></pre>
<p>When you attempt to read the value of a characteristic, the peripheral calls the <code>peripheral:didUpdateValueForCharacteristic:error:</code> method of its delegate object to retrieve the value. If the value is successfully retrieved, you can access it through the characteristic&apos;s value property. </p>
<pre><code class="lang-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">peripheral</span><span class="hljs-params">(<span class="hljs-number">_</span> peripheral: CBPeripheral, didUpdateValueFor characteristic: CBCharacteristic, error: Error?)</span></span> {
    <span class="hljs-keyword">var</span> data: <span class="hljs-type">Data</span>? = characteristic.value
    <span class="hljs-comment">// parse the data as needed</span>
}
</code></pre>
<blockquote>
<p><strong>Note:</strong> Not all characteristics are readable. You can determine whether a characteris is readable by checking if its <code>properties</code> attribute includes the <code>CBCharacteristicPropertyRead</code> constant. If you try to read a value of a characteristic that isn&apos;t readable, <code>peripheral:didUpdateValueForCharacteristic:error:</code> delegate method returns a suitable error</p>
</blockquote>
<h3 id="subscribing-to-a-characteristics-value">Subscribing to a Characteristic&apos;s Value</h3>
<p>Through reading the value of a characteristic using the <code>readValueForCharacter:</code> method can be effective for static values. But, it&apos;s not the best for dynamic value. For example, your heart rate monitor may change value. </p>
<pre><code class="lang-swift">peripheral.setNotifyValue(<span class="hljs-literal">true</span>, <span class="hljs-keyword">for</span>: interestingCharacteristic)
</code></pre>
<p>When you subscribe, the peripheral calls the <code>peripheral:didUpdateNotificationStateForCharacteristic:error:</code> method of its delegate object. </p>
<pre><code class="lang-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">peripheral</span><span class="hljs-params">(<span class="hljs-number">_</span> peripheral: CBPeripheral, didUpdateNotificationStateForCharacteristic characteristic: CBCharacteristic, error: Error?)</span></span> <span class="hljs-keyword">throws</span> {
    <span class="hljs-keyword">if</span> error != <span class="hljs-literal">nil</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error changing notification state: <span class="hljs-subst">\(error?.localizedDescription)</span>&quot;</span>)
    }
}
</code></pre>
<blockquote>
<p>Not all characteristics offer subscription. You can determine if a characteristic offers subscript by checking if its properties attribute include either of the <code>CBCharacteristicPropertyNotify</code> or <code>CBCharacteristicPropertyIndicate</code> constants. </p>
</blockquote>
<p>After time the peripheral device notifies your app when the value has changed and it calls, <code>peripheral:didUpdateValueForCharacteristic:error:</code> method of its delegate object. </p>
<h2 id="writing-the-value-of-a-characteristic">Writing the Value of a Characteristic</h2>
<p>If you&apos;d like to control your thermostat with your phone, you should be able to. If a characteristic&apos;s value is writeable, you can write by calling the peripheral&apos;s, <code>writeValue:forCharacteristic:type:</code> method. </p>
<pre><code class="lang-swift"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Writing value for characteristic <span class="hljs-subst">\(interestingCharacteristic)</span>&quot;</span>)
peripheral.writeValue(dataToWrite, forCharacteristic: interestingCharacteristic, type: <span class="hljs-type">CBCharacteristicWriteWithResponse</span>)
</code></pre>
<p>When you write the value of a characteristic, you specify what type of write you want to perform. The type above is <code>CBCharacteristicWriteWithResponse</code> which instructs the peripheral to let your app know whether or not the write succeeds by calling the <code>peripheral:didWriteValueForCharacteristic:error:</code> method of its delegate object. You also implement this delegate method to the handle the error condition, as the following example shwos: </p>
<pre><code class="lang-swift"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">peripheral</span><span class="hljs-params">(<span class="hljs-number">_</span> peripheral: CBPeripheral, didWriteValueForCharacteristic characteristic: CBCharacteristic, error: Error?)</span></span> <span class="hljs-keyword">throws</span> {
    <span class="hljs-keyword">if</span> error != <span class="hljs-literal">nil</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error writing characteristic value: <span class="hljs-subst">\(error?.localizedDescription)</span>&quot;</span>)
    }
}
</code></pre>
<p>If instead you specify the write type as <code>CBCharacteristicWriteWithoutResponse</code>, the write operation is performed as best-effort, and delivery is neither guarantteed nor reported. The peripheral does not call the delegate method. </p>
<h1 id="core-bluetooth-background-processing-for-ios-apps">Core Bluetooth Background Processing for iOS Apps</h1>
<p>By default, Core Bluetooth tasks on both the central and peripheral side are disabled while your app is in the background or in a suspended state. But, you can declare your app to support the Core Bluetooth background execution modes. Of course, it can&apos;t run forever. The system may have to terminate to free up memory. </p>
<p>However, you can warn your user when you are about to go to the suspended state</p>
<p><code>CBConnectPeripheralOptionNotifyOnConnectionKey</code>&#x2014;Include this key if you want the system to display an alert for a given peripheral if the app is suspended when a successful connection is made.</p>
<p><code>CBConnectPeripheralOptionNotifyOnDisconnectionKey</code>&#x2014;Include this key if you want the system to display a disconnection alert for a given peripheral if the app is suspended at the time of the disconnection.</p>
<p><code>CBConnectPeripheralOptionNotifyOnNotificationKey</code>&#x2014;Include this key if you want the system to display an alert for all notifications received from a given peripheral if the app is suspended at the time</p>
<h2 id="core-bluetooth-background-execution-modes">Core Bluetooth Background Execution Modes</h2>
<p>If your app needs to run in background to perform certain Bluetooth-related tasks, you must declare in <code>Info.plist</code> You add <code>UIBackgroundModes</code> key and setting the key&apos;s value to an array containing one of the followings</p>
<p><code>bluetooth-central</code>&#x2014;The app communicates with Bluetooth low energy peripherals using the Core Bluetooth framework.
<code>bluetooth-peripheral</code>&#x2014;The app shares data using the Core Bluetooth framework.</p>
<h3 id="the-bluetooth-central-background-execution-mode">The bluetooth-central Background Execution Mode</h3>
<p>Now, the Core Bluetooth framework allows your app to run in the background to perfrom certain Bluetooth-related tasks. While you are in the background, you can still discover and connect to peripherals and explore and interact with peripheral data. The system also wakes up your app when any of <code>CBCentralManagerDelegate</code> or <code>CBPeripheralDelegate</code> delegate mthods are invoked. These are used for when a connection is made/lost, when your app receives updated characteristic values. </p>
<p>However, still you are performing many bluetooth related tasks, it&apos;s different from scanning for peripherals in the foreground. For example, in the back ground, The <code>CBCentralManagerScanOptionAllowDuplicatesKey</code> scan option key is ignored, multiple discoveries of an advertising peripheral are coalesced into a single discovery event. Second, if all apps are scanning for peripherals are in the background, ther interval at which your central devcie scans for advertising packets increases, thus slowing down discovering advertising peripherals. These changes help minimizing battery and radio usage. </p>
<h2 id="use-background-execution-modes-wisely">Use Background Execution Modes Wisely</h2>
<ol>
<li>App should be session based and provide an interface that allows the user to decide when to start and stop the delivery of Bluetooth-related events. </li>
<li>Upon being woken up, an app has around 10 seconds to complete a task. It should complete the task as fast as possible and allow itself to be suspended again. Apps that spend too much time executing in the background can be throttled back by the system or killed. </li>
</ol>
<h2 id="performing-long-term-actions-in-the-background">Performing Long-Term Actions in the Background</h2>
<p>Imagine you are developing a home security app for an iOS device that communicates with a door lock. The app and the lock interact to automatically lock the door when the user leaves home and unlock the door when the user returns -- all while in the background. When the user leaves home, the out of range causes the lock to be locked. </p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Bluetooth Low Energy","level":"1.5.1","depth":2,"next":{"title":"Animation","level":"1.5.2","depth":2,"ref":"","articles":[]},"previous":{"title":"iOS APIs","level":"1.5","depth":1,"ref":"","articles":[{"title":"Bluetooth Low Energy","level":"1.5.1","depth":2,"path":"Content/01_Swift_3/Bluetooth_Low_Energy.md","ref":"Content/01_Swift_3/Bluetooth_Low_Energy.md","articles":[]},{"title":"Animation","level":"1.5.2","depth":2,"ref":"","articles":[]},{"title":"Memory Management","level":"1.5.3","depth":2,"ref":"","articles":[]},{"title":"Grand Central Dispatch","level":"1.5.4","depth":2,"ref":"","articles":[]},{"title":"Memory Management","level":"1.5.5","depth":2,"path":"Content/01_Swift_3/Memory_Management.md","ref":"Content/01_Swift_3/Memory_Management.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Content/01_Swift_3/Bluetooth_Low_Energy.md","mtime":"2017-02-04T00:09:49.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-02-07T02:01:37.729Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

